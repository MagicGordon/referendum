{"version":3,"sources":["App.js","index.js"],"names":["TGas","Big","pow","BoatOfGas","mul","nearAPI","format","formatNearAmount","parseNearAmount","ReferendumContractName","App","props","state","connected","signedIn","accountId","digitals","all_digitals","own_digital","target_digital","levelup_target","xref_balance","near_balance","lock_amount","lock_session","mint_amount","referend_meta","query_proposal_id","proposal_info","redeem_proposal_id","remove_proposal_id","action_proposal_id","action","memo","description","policy_type","session_id","start_offset_sec","lasts_sec","latest_block_time","_digitalRefreshTimer","handleMintAmountChange","bind","mintSubmit","handleLockAmountChange","handleLockSessionChange","lockSubmit","handleDescriptionChange","handlePolicyTypeChange","handleSessionIdChange","handleStartChange","handleLastsChange","addProposalSubmit","handleQueryProposalChange","queryProposalSubmit","handleRedeemChange","redeemSubmit","handleRemoveChange","removeSubmit","handleActionIdChange","handleActionChange","handleMemoChange","actionSubmit","_initNear","then","setState","_accountId","a","this","_near","connection","provider","status","blockchain_status","now","Date","sync_info","parseInt","getTime","_account","getAccountBalance","console","log","available","seconds","_referendumContract","contract_metadata","modify_genesis_timestamp","genesis_timestamp_in_sec","window","location","reload","_xref_contract","ft_balance_of","account_id","setInterval","query_digitals","nearConfig","networkId","nodeUrl","walletUrl","helperUrl","explorerUrl","keyStore","BrowserLocalStorageKeyStore","Object","assign","deps","near","_keyStore","_nearConfig","_walletConnection","getAccountId","account","viewMethods","changeMethods","storage_balance_of","storage_deposit","referendum_storage_balance_of","total","refreshAccountStats","requestSignIn","signOut","mint","amount","toFixed","event","target","value","action_mint","preventDefault","ft_transfer_call","receiver_id","msg","action_lock","add_proposal","kind","lock_amount_per_proposal","res","alert","addProposal","get_proposal_info","proposal_id","query_proposal","redeem_near_in_expired_proposal","id","redeem_proposal","remove_proposal","act_proposal","action_proposal","content","className","onClick","logOut","nonsense_threshold","numerator","denominator","vote_policy","Relative","Absolute","cur_total_ballot","cur_lock_amount","genesis_timestamp_sec","cur_session_id","onSubmit","type","style","marginLeft","onChange","JSON","stringify","marginBottom","role","aria-hidden","React","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.ace001d9.chunk.js","sourcesContent":["import \"./App.css\";\nimport React from 'react';\n// import BN from 'bn.js';\nimport * as nearAPI from 'near-api-js'\nimport Big from 'big.js';\n\nconst TGas = Big(10).pow(12);\nconst BoatOfGas = Big(200).mul(TGas);\n\nconst {\nutils: {\n  format: { \n    formatNearAmount, parseNearAmount\n  }\n}\n} = nearAPI;\n\nconst ReferendumContractName = 'dev-1641457721804-95400731314713';\nconst XrefContractName = 'dev-1641291247531-69951278398392';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      connected: false,\n      signedIn: false,\n      accountId: null,\n      digitals: [],\n      all_digitals: [],\n      own_digital: \"\",\n      target_digital: \"\",\n      levelup_target:\"\",\n      xref_balance: 0,\n      near_balance: 0,\n\n      lock_amount: 0,\n      lock_session: 0,\n      mint_amount: 0,\n\n      referend_meta: null,\n\n      query_proposal_id: 0,\n      proposal_info: null,\n\n      redeem_proposal_id:0,\n\n      remove_proposal_id: 0,\n\n      action_proposal_id: 0,\n      action: '',\n      memo: '',\n      //proposal\n      description: '',\n      policy_type: '',\n      session_id: 0,\n      start_offset_sec:'',\n      lasts_sec: 60,\n\n\n      latest_block_time: 0,\n\n    };\n\n    this._digitalRefreshTimer = null;\n\n\n    this.handleMintAmountChange = this.handleMintAmountChange.bind(this);\n    this.mintSubmit = this.mintSubmit.bind(this);\n\n    this.handleLockAmountChange = this.handleLockAmountChange.bind(this);\n    this.handleLockSessionChange = this.handleLockSessionChange.bind(this);\n    this.lockSubmit = this.lockSubmit.bind(this);\n \n    this.handleDescriptionChange = this.handleDescriptionChange.bind(this);\n    this.handlePolicyTypeChange = this.handlePolicyTypeChange.bind(this);\n    this.handleSessionIdChange = this.handleSessionIdChange.bind(this);\n    this.handleStartChange = this.handleStartChange.bind(this);\n    this.handleLastsChange = this.handleLastsChange.bind(this);\n    this.addProposalSubmit = this.addProposalSubmit.bind(this);\n\n\n    this.handleQueryProposalChange = this.handleQueryProposalChange.bind(this);\n    this.queryProposalSubmit = this.queryProposalSubmit.bind(this);\n\n    this.handleRedeemChange = this.handleRedeemChange.bind(this);\n    this.redeemSubmit = this.redeemSubmit.bind(this);\n\n    this.handleRemoveChange = this.handleRemoveChange.bind(this);\n    this.removeSubmit = this.removeSubmit.bind(this);\n\n\n    this.handleActionIdChange = this.handleActionIdChange.bind(this);\n    this.handleActionChange = this.handleActionChange.bind(this);\n    this.handleMemoChange = this.handleMemoChange.bind(this);\n    this.actionSubmit = this.actionSubmit.bind(this);\n\n    this._initNear().then(() => {\n      this.setState({\n        connected: true,\n        signedIn: !!this._accountId,\n        accountId: this._accountId,\n      });\n    });\n  }\n\n  componentDidMount() {\n  }\n\n\n  async query_digitals() {\n    // let digitals = await this._contract.get_digitals({ accountId: this._accountId })\n    // let all_digitals = await this._contract.get_all_digitals({ accountId: this._accountId })\n    \n    let blockchain_status = await this._near.connection.provider.status();\n    let now = new Date(blockchain_status.sync_info.latest_block_time)\n    this.setState({\n      latest_block_time: parseInt(now.getTime() / 1000)\n    })\n  }\n\n  async refreshAccountStats() {\n    // let digitals = await this._contract.get_digitals({ accountId: this._accountId });\n    // let all_digitals = await this._contract.get_all_digitals({ accountId: this._accountId })\n    // if (this._digitalRefreshTimer) {\n    //   clearInterval(this._digitalRefreshTimer);\n    //   this._digitalRefreshTimer = null;\n    // }\n\n    // const near_account = await this._near.account(this._accountId);\n    let near_balance = await this._account.getAccountBalance();\n    console.log(formatNearAmount(near_balance.available))\n\n    let blockchain_status = await this._near.connection.provider.status();\n    console.log(blockchain_status.sync_info.latest_block_time)\n\n    let now = new Date(blockchain_status.sync_info.latest_block_time);\n    let seconds = parseInt(now.getTime() / 1000);\n    console.log(seconds)\n    let referend_meta = null;\n    try{\n      referend_meta = await this._referendumContract.contract_metadata();\n      console.log(referend_meta)\n    }catch(e){\n      await this._referendumContract.modify_genesis_timestamp({ genesis_timestamp_in_sec: seconds + 30 });\n      window.location.reload()\n    }\n\n    let xref_balance = await this._xref_contract.ft_balance_of({ account_id: this._accountId });\n\n    this.setState({\n      // digitals: digitals,\n      // all_digitals: all_digitals,\n      referend_meta: referend_meta,\n      near_balance: near_balance.available,\n      xref_balance: xref_balance,\n    });\n\n    this._digitalRefreshTimer = setInterval(() => {\n      this.query_digitals();\n    }, 5000);\n  }\n\n  async _initNear() {\n    const nearConfig = {\n      networkId: 'testnet',\n      nodeUrl: 'https://rpc.testnet.near.org',\n      // contractName: ContractName,\n      walletUrl: 'https://wallet.testnet.near.org',\n      helperUrl: \"https://helper.testnet.near.org\",\n      explorerUrl: \"https://explorer.testnet.near.org\",\n    };\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearAPI.connect(Object.assign({ deps: { keyStore } }, nearConfig));\n    this._keyStore = keyStore;\n    this._nearConfig = nearConfig;\n    this._near = near;\n\n    this._walletConnection = new nearAPI.WalletConnection(near, XrefContractName);\n    this._accountId = this._walletConnection.getAccountId();\n\n    this._account = this._walletConnection.account();\n    if (this._accountId) {\n      this._referendumContract = new nearAPI.Contract(this._account, ReferendumContractName, {\n        viewMethods: ['contract_metadata', 'get_proposal_info', 'get_proposals_in_session', 'get_proposal_ids_in_session', 'get_account_info', 'get_account_proposals_in_session', 'storage_balance_of'],\n        changeMethods: ['add_proposal', 'remove_proposal', 'redeem_near_in_expired_proposal', 'act_proposal', 'modify_genesis_timestamp', 'storage_deposit'],\n      });\n  \n      this._xref_contract = new nearAPI.Contract(this._account, XrefContractName, {\n        viewMethods: ['ft_balance_of', 'storage_minimum_balance', 'storage_balance_of'],\n        changeMethods: ['storage_deposit', 'mint', 'ft_transfer_call', 'ft_transfer'],\n      });\n\n      let xref_storage_balance_of_referendum = await this._xref_contract.storage_balance_of({ account_id: ReferendumContractName });\n      if (xref_storage_balance_of_referendum == null) {\n        await this._xref_contract.storage_deposit({ account_id: ReferendumContractName }, \"200000000000000\", parseNearAmount('0.01'))\n      }\n\n      let referendum_storage_balance_of = await this._referendumContract.storage_balance_of({ account_id: this._accountId });\n      if (referendum_storage_balance_of == null) {\n        await this._referendumContract.storage_deposit({ account_id: this._accountId }, \"200000000000000\", parseNearAmount('0.01'))\n      }\n      console.log('referendum_storage_balance_of', formatNearAmount(referendum_storage_balance_of.total))\n      let xref_storage_balance_of = await this._xref_contract.storage_balance_of({ account_id: this._accountId });\n      if (xref_storage_balance_of == null) {\n        await this._xref_contract.storage_deposit({ account_id: this._accountId }, \"200000000000000\", parseNearAmount('0.01'))\n      }\n      await this.refreshAccountStats();\n    }else{\n      console.log(\"not login\");\n    }\n  }\n\n\n  async requestSignIn() {\n    const appTitle = 'Referendum';\n    await this._walletConnection.requestSignIn(\n      ReferendumContractName,\n      appTitle\n    )\n  }\n\n  async logOut() {\n    this._walletConnection.signOut();\n    this._accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      accountId: this._accountId,\n    })\n  }\n\n  async action_mint(){\n    await this._xref_contract.mint({ account_id: this.state.accountId, amount: parseNearAmount(this.state.mint_amount)}, BoatOfGas.toFixed(0))\n  }\n  handleMintAmountChange(event) {    this.setState({mint_amount: event.target.value});  }\n  mintSubmit(event) {\n    this.action_mint();\n    event.preventDefault();\n  }\n\n  async action_lock(){\n    let res = await this._xref_contract.ft_transfer_call({ receiver_id: ReferendumContractName, amount: parseNearAmount(this.state.lock_amount), msg: this.state.lock_session}, \"200000000000000\", 1)\n  }\n  handleLockAmountChange(event) {    this.setState({lock_amount: event.target.value});  }\n  handleLockSessionChange(event) {    this.setState({lock_session: event.target.value});  }\n  lockSubmit(event) {\n    this.action_lock();\n    event.preventDefault();\n  }\n\n  async addProposal(){\n    let res = await this._referendumContract.add_proposal({ \n      description: this.state.description, \n      kind: 'Vote', \n      policy_type: this.state.policy_type,\n      session_id: parseInt(this.state.session_id, 10),\n      start_offset_sec: parseInt(this.state.start_offset_sec, 10),\n      lasts_sec: parseInt(this.state.lasts_sec, 10),\n    }, \"200000000000000\", this.state.referend_meta.lock_amount_per_proposal)\n    alert(res)\n    window.location.reload()\n  }\n  handleDescriptionChange(event) {    this.setState({description: event.target.value});  }\n  handlePolicyTypeChange(event) {    this.setState({policy_type: event.target.value});  }\n  handleSessionIdChange(event) {    this.setState({session_id: event.target.value});  }\n  handleStartChange(event) {    this.setState({start_offset_sec: event.target.value});  }\n  handleLastsChange(event) {    this.setState({lasts_sec: event.target.value});  }\n  addProposalSubmit(event) {\n    this.addProposal();\n    event.preventDefault();\n  }\n\n  async query_proposal(){\n    let res = await this._referendumContract.get_proposal_info({ proposal_id: parseInt(this.state.query_proposal_id, 10)})\n    console.log(res)\n    this.setState({proposal_info: res})\n  }\n  handleQueryProposalChange(event) {    this.setState({query_proposal_id: event.target.value});  }\n  queryProposalSubmit(event) {\n    this.query_proposal();\n    event.preventDefault();\n  }\n\n  async redeem_proposal(){\n    await this._referendumContract.redeem_near_in_expired_proposal({ id: parseInt(this.state.redeem_proposal_id, 10)}, \"200000000000000\")\n  }\n  handleRedeemChange(event) {    this.setState({redeem_proposal_id: event.target.value});  }\n  redeemSubmit(event) {\n    this.redeem_proposal();\n    event.preventDefault();\n  }\n\n  async remove_proposal(){\n    await this._referendumContract.remove_proposal({ id: parseInt(this.state.remove_proposal_id, 10)}, \"200000000000000\")\n  }\n  handleRemoveChange(event) {    this.setState({remove_proposal_id: event.target.value});  }\n  removeSubmit(event) {\n    this.remove_proposal();\n    event.preventDefault();\n  }\n\n  async action_proposal(){\n    await this._referendumContract.act_proposal({ id: parseInt(this.state.action_proposal_id, 10),\n      action: this.state.action, \n      memo: this.state.memo, \n    }, \"200000000000000\")\n  }\n  handleActionIdChange(event) {    this.setState({action_proposal_id: event.target.value});  }\n  handleActionChange(event) {    this.setState({action: event.target.value});  }\n  handleMemoChange(event) {    this.setState({memo: event.target.value});  }\n  actionSubmit(event) {\n    this.action_proposal();\n    event.preventDefault();\n  }\n\n  render() {\n    const content = !this.state.connected ? (\n      <div>Connecting... <span className=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span></div>\n    ) : (this.state.signedIn ? (\n      <div>\n        <div className=\"float-right\">\n          <button\n            className=\"btn btn-outline-secondary\"\n            onClick={() => this.logOut()}>Log out</button>\n        </div>\n        <h4>Hello, <span className=\"font-weight-bold\">{this.state.accountId}</span>!</h4>\n        <h4>near balance: <span className=\"font-weight-bold\">{formatNearAmount(this.state.near_balance)}</span></h4>\n        <h4>xref balance: <span className=\"font-weight-bold\">{formatNearAmount(this.state.xref_balance)}</span></h4>\n        <hr></hr>\n        <h4>threshold nonsense: <span className=\"font-weight-bold\">{ this.state.referend_meta.nonsense_threshold.numerator + \"/\" + this.state.referend_meta.nonsense_threshold.denominator}</span></h4>\n        <h4>threshold Relative minimum voting: <span className=\"font-weight-bold\">{ this.state.referend_meta.vote_policy[0].Relative[0].numerator + \"/\" + this.state.referend_meta.vote_policy[0].Relative[0].denominator}</span></h4>\n        <h4>threshold Relative judgement: <span className=\"font-weight-bold\">{this.state.referend_meta.vote_policy[0].Relative[1].numerator + \"/\" + this.state.referend_meta.vote_policy[0].Relative[1].denominator}</span></h4>\n        <h4>threshold Absolute Pass: <span className=\"font-weight-bold\">{ this.state.referend_meta.vote_policy[1].Absolute[0].numerator + \"/\" + this.state.referend_meta.vote_policy[1].Absolute[0].denominator}</span></h4>\n        <h4>threshold Absolute Fail: <span className=\"font-weight-bold\">{ this.state.referend_meta.vote_policy[1].Absolute[1].numerator + \"/\" + this.state.referend_meta.vote_policy[1].Absolute[1].denominator}</span></h4>\n        <h4>lock_amount_per_proposal(Near): <span className=\"font-weight-bold\">{ formatNearAmount(this.state.referend_meta.lock_amount_per_proposal)}</span></h4>\n        <h4>cur_total_ballot: <span className=\"font-weight-bold\">{ formatNearAmount(this.state.referend_meta.cur_total_ballot) }</span></h4>\n        <h4>cur_lock_amount: <span className=\"font-weight-bold\">{ formatNearAmount(this.state.referend_meta.cur_lock_amount) }</span></h4>\n        <hr></hr>\n        <h4>latest_block_time: <span className=\"font-weight-bold\">{ this.state.latest_block_time }</span></h4>\n        <h4>offset_current_seesion_begin + 30: <span className=\"font-weight-bold\">{ \n        this.state.latest_block_time === 0 ? 0 : this.state.latest_block_time - \n        this.state.referend_meta.genesis_timestamp_sec - \n        this.state.referend_meta.cur_session_id * 3600 * 24 * 30\n         + 30 }</span></h4>\n         <h4>offset_current_seesion_begin + 60: <span className=\"font-weight-bold\">{ \n        this.state.latest_block_time === 0 ? 0 : this.state.latest_block_time - \n        this.state.referend_meta.genesis_timestamp_sec - \n        this.state.referend_meta.cur_session_id * 3600 * 24 * 30\n         + 60 }</span></h4>\n        <hr></hr>\n        <form onSubmit={this.mintSubmit}>\n          <label> mint xref: <input type=\"text\" style={{marginLeft:\"74px\"}} value={this.state.mint_amount} onChange={(event) => {this.handleMintAmountChange(event)}} /> </label><br/>\n          <input type=\"submit\" value=\"mint\" />\n        </form>\n        <hr></hr>\n        <form onSubmit={this.lockSubmit}>\n          <label> lock xref: <input type=\"text\" style={{marginLeft:\"74px\"}} value={this.state.lock_amount} onChange={(event) => {this.handleLockAmountChange(event)}} /> </label><br/>\n          <label> lock session: <input type=\"text\" style={{marginLeft:\"48px\"}} value={this.state.lock_session} onChange={(event) => {this.handleLockSessionChange(event)}} /> </label><br/>\n          <input type=\"submit\" value=\"lock\" />\n        </form>\n        <hr></hr>\n        <form onSubmit={this.addProposalSubmit}>\n          <label> description: <input type=\"text\" style={{marginLeft:\"70px\"}} value={this.state.description} onChange={(event) => {this.handleDescriptionChange(event)}} /> </label><br/>\n          <label> policy_type: <input type=\"text\" style={{marginLeft:\"67px\"}} value={this.state.policy_type} onChange={(event) => {this.handlePolicyTypeChange(event)}} /> </label>Relative/Absolute<br/>\n          <label> session_id: <input type=\"text\" style={{marginLeft:\"74px\"}} value={this.state.session_id} onChange={(event) => {this.handleSessionIdChange(event)}} /> </label><br/>\n          <label> start_offset_sec(s): <input type=\"text\" style={{marginLeft:\"11px\"}} value={this.state.start_offset_sec} onChange={(event) => {this.handleStartChange(event)}} /> </label><br/>\n          <label> duration(s): <input type=\"text\" style={{marginLeft:\"70px\"}} value={this.state.lasts_sec} onChange={(event) => {this.handleLastsChange(event)}} /> </label><br/>\n          <input type=\"submit\" value=\"addProposal\" />\n        </form>\n        <hr></hr>\n        <form onSubmit={this.queryProposalSubmit}>\n          <label> query proposal id: <input type=\"text\" style={{marginLeft:\"74px\"}} value={this.state.query_proposal_id} onChange={(event) => {this.handleQueryProposalChange(event)}} /> </label><br/>\n          <label> proposal info: <span className=\"font-weight-bold\">{ JSON.stringify(this.state.proposal_info) }</span> </label><br/>\n          <label> expire time: <span className=\"font-weight-bold\">{ \n            this.state.proposal_info == null ? 0 : \n            this.state.referend_meta.genesis_timestamp_sec +  \n            this.state.referend_meta.cur_session_id * 3600 * 24 * 30 +\n            this.state.proposal_info.start_offset_sec + this.state.proposal_info.lasts_sec\n           }</span> </label><br/>\n          <input type=\"submit\" value=\"query proposal\" />\n        </form>\n        <hr></hr>\n        <form onSubmit={this.redeemSubmit}>\n          <label> redeem proposal id: <input type=\"text\" style={{marginLeft:\"74px\"}} value={this.state.redeem_proposal_id} onChange={(event) => {this.handleRedeemChange(event)}} /> </label><br/>\n          <input type=\"submit\" value=\"redeem\" />\n        </form>\n        <hr></hr>\n        <form onSubmit={this.removeSubmit}>\n          <label> remove proposal id: <input type=\"text\" style={{marginLeft:\"74px\"}} value={this.state.remove_proposal_id} onChange={(event) => {this.handleRemoveChange(event)}} /> </label><br/>\n          <input type=\"submit\" value=\"remove\" />\n        </form>\n        <hr></hr>\n        <form onSubmit={this.actionSubmit}>\n          <label> id: <input type=\"text\" style={{marginLeft:\"105px\"}} value={this.state.action_proposal_id} onChange={(event) => {this.handleActionIdChange(event)}} /> </label><br/>\n          <label> action: <input type=\"text\" style={{marginLeft:\"74px\"}} value={this.state.action} onChange={(event) => {this.handleActionChange(event)}} /> </label>VoteApprove/VoteReject/VoteNonsense<br/>\n          <label> memo: <input type=\"text\" style={{marginLeft:\"74px\"}} value={this.state.memo} onChange={(event) => {this.handleMemoChange(event)}} /> </label><br/>\n          <input type=\"submit\" value=\"action\" />\n        </form>\n        <hr></hr>\n      </div>\n    ) : (\n      <div style={{ marginBottom: \"10px\" }}>\n        <button\n          className=\"btn btn-primary\"\n          onClick={() => this.requestSignIn()}>Log in with NEAR Wallet</button>\n      </div>\n    ));\n    return (\n      <div className=\"px-5\">\n        <h1>Referendum</h1>\n        {content}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}